

Unicode 与 utf-8

术语：

1. 字符集：多个字符的集合。
2. 字符编码：字符在某一特定集合中的代号。
3. 编码：信息从一种形式或格式转换为另一种形式的过程。
4. 字节： 一个字节为8个二进制数字组成，如010110001。



### ASCII码

> 一个字节为什么是8位二进制编码表示，而不是9位，10位？

我们知道，计算机内部，所有信息最终都是一个二进制。每一个二进制位（bit）有`0`和`1`两种状态。最初美国需要一套字符编码来表示英语字符与二进制位之间的关系，当时需要表示的字符（英文字母+显示符号+非显示操作）共有128个，共需要8个二进制位才能表示出（2^8=256），于是规定二进制的首位是0，就表示出了128个字符，也就成了后来的ASCII码。

### Unicode

英语用128个符号编码就够了，但是用来表示其他语言，128个符号是不够的。如汉语、法语、日文等。于是，欧洲、中国

等便根据各自国家的语言编写了一套自己的码表及编码规则，如简体中文的 GB2312 编码等。于是，世界上就出现了多种

编码规则，在不知道编码规则的情况下去读取一个文件，往往会出现乱码的情况。

于是，世界XX组织，就出了一套字符集，将世界上所有符号都纳入其中，每个符号的编码都不一样，大约容纳了100多万个字符。这样，全世界的码表就统一了，而这，就是unicode。

unicode是一个收集了全世界所有符号，且为它们分别分配了唯一二进制编码的字符集，一张码表。当前已收纳约100万左右的字符。[官网 ](http://www.unicode.org/)采用了16进制对齐进行表示，如图

注意：

> Unicode只规定了每个字符对应的二进制编码（如 ‘汉’ 字，其对应的二进制码为： 110110001001001），却没有规定这个二进制代码应该如何存储。

>世界上存在着多种编码方式，同一个二进制数字可以被解释成不同的符号, 如 10进制，16进制等。

>与ASCII码不同，Unicode采用多个字节表示一个字符，如汉字 '严' 就是2个字节（100111000100101），表示其他更大的符号，可能需要3个字节或者4个字节，甚至更多。

### Unicode 的问题

1）如何才能区别 Unicode 和 ASCII ？计算机怎么知道三个字节表示一个符号，而不是分别表示三个符号呢？

2）我们已经知道，英文字母只用一个字节表示就够了，如果 Unicode 统一规定，每个符号用三个或四个字节表示，那么每个英文字母前都必然有二到三个字节是`0`，这对于存储来说是极大的浪费，文本文件的大小会因此大出二三倍，这是无法接受的。

它们造成的结果是：

1）出现了 Unicode 的多种存储方式，也就是说有许多种不同的二进制格式，可以用来表示 Unicode，如10进制，16进制等。

2）Unicode 在很长一段时间内无法推广，直到互联网的出现。

### UTF-8

因为Unicode只是表示了字符与二进制码之间的关系，并没有规定如何存储，如果我们以固定的4或5个字节的长度来表示

一个字符，如 0000 0000 0000 007F，那么前面的3个自动补充0的字节就会造成存储资源浪费。于是，就产生了一种可变长的编码方式UTF-8。它最大的特点就是可以使用1~4个字节表示一个符号，根据不同的符号而变化字节长度。

UTF-8 的编码规则很简单，只有两条：

1）对于单字节的符号，字节的第一位设为`0`，后面7位为这个符号的 Unicode 码。因此对于英语字母，UTF-8 编码和 ASCII 码是相同的。

2）对于`n`字节的符号（`n > 1`），第一个字节的前`n`位都设为`1`，第`n + 1`位设为`0`，后面字节的前两位一律设为`10`。剩下的没有提及的二进制位，全部为这个符号的 Unicode 码。

下表总结了编码规则，字母`x`表示可用编码的位。

```
Unicode符号范围      |        UTF-8编码方式
(十六进制)           |              （二进制）
----------------------+---------------------------------------------
0000 0000-0000 007F | 0xxxxxxx
0000 0080-0000 07FF | 110xxxxx 10xxxxxx
0000 0800-0000 FFFF | 1110xxxx 10xxxxxx 10xxxxxx
0001 0000-0010 FFFF | 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx
```

下面，还是以汉字`严`为例，演示如何实现 UTF-8 编码。

`严`的 Unicode 是`4E25`（`100111000100101`），根据上表，可以发现`4E25`处在第三行的范围内（`0000 0800 - 0000 FFFF`），因此`严`的 UTF-8 编码需要三个字节，即格式是`1110xxxx 10xxxxxx 10xxxxxx`。然后，从`严`的最后一个二进制位开始，依次从后向前填入格式中的`x`，多出的位补`0`。这样就得到了，`严`的 UTF-8 编码是`11100100 10111000 10100101`，转换成十六进制就是`E4B8A5`。

总结：UTF-8 是一种针对Unicode，通过特定规则来表示字符与二进制之间关系的可变长度的编码方式，是字符与二进制之间的中间态，用来利于存储的一套编码。



严 -->

所以，我们现在的编码流程就是：各种语言的原始文件 --> 编译后的存储文件（如符合utf-8标准的）--> 被计算机识别的二进制文件 --> 计算机设备对二进制编码的识别与运行。